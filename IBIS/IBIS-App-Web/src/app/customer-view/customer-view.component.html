<ion-content class="ion-margin" id="htmlData">
    <div class="contents">
      <h1 style="color: black;">{{welcome}}</h1>
      <h1>Your Orders</h1>
      <mat-form-field>
        <input matInput type="search" placeholder="Search Orders..." [(ngModel)]="filterTerm">
      </mat-form-field>
      
      <!-- <ion-searchbar class="isb" placeholder="Search Inventory..." showCancelButton="focus" [(ngModel)]="filterTerm" animated></ion-searchbar><br/> -->
      <!-- <dialog style="z-index: 100;" #myDialog class="modal">
        <h1 mat-dialog-title>Enter Review</h1>
        <form FormGroup="form">
          <mat-form-field>
        <textarea matInput placeHolder="Enter Review" formControlName="review"> 
      </textarea>
    </mat-form-field>
        <br><button  [disabled]="!form.valid" (click)="SubmitReview();myDialog.close()">Submit</button>
        <button mat-raised-button (click)="closeDialog();myDialog.close()">Cancel</button>
      </form>
     
      </dialog> -->
      <mat-form-field style="float: right;"  >
        <mat-label>Select Orders</mat-label>
        <mat-select (selectionChange)="FilterOrders()" [(ngModel)]="selectedStatus"  >
          <mat-option *ngFor="let status of statusResults" [value]="status.status_ID">
            {{status.Name}}
          </mat-option>
        </mat-select>
        
      </mat-form-field>
      <table mat-table #orderTable [dataSource]="dataSource" class="mat-elevation-z0">
        <ng-container [matColumnDef]="col.key" *ngFor="let col of columnsSchema">
          <th mat-header-cell  *matHeaderCellDef>
            {{ col.name }}
          </th>
          <td mat-cell *matCellDef="let item" [ngSwitch]="col.key">  
                  <ng-container *ngSwitchCase="'actions'">
                    
                  <ng-container [ngSwitch]="selectedStatus"> 
                  <div >
                   
                      
                        <div *ngSwitchCase="1">
                      <ion-button (click)="ViewOrder(item)" class="red-btn" >View</ion-button>
                     
                      <form *ngIf="environment.production != true" #form ngNoForm action="https://sandbox.payfast.co.zaâ€‹/eng/process" method="POST" >
                        <input type="hidden" name="merchant_id" value="10000100">
                        <input type="hidden" name="merchant_key" value="46f0cd694581a">
                         <input type="hidden" name="amount" value="{{CalculateTotal(item.customerOrder_ID)}}">
                        <input type="hidden" name="item_name" value="{{item.customerOrder_ID}}">
                        <!-- <input type="hidden" name="signauture" value="jt7NOE43FZPn"> -->
                         <input type="hidden" name="notify_url" value="https://inf370team62023.azurewebsites.net/api/ManytoMany/Notify">
                         <input type="hidden" name="return_url" value="https://testangular.azurewebsites.net/customer-view"> 
                         <input type="hidden" name="email_address" value="john@doe.com" />
                         <ion-button type="submit" *ngIf="!item.transaction_ID" class="red-btn" matTooltip="checkout">Checkout</ion-button>
                        
                     </form> 
                     
                     <ion-button (click)="Check(item)" *ngIf="!item.transaction_ID" class="red-btn" matTooltip="checkout">PayPal</ion-button>
                        </div>
                      
                      <div *ngSwitchCase="2">
                        <ion-button (click)="ViewOrder(item)" class="red-btn" matTooltip="View">View</ion-button>
                        <ion-button *ngIf="permissions" (click)="SubmitReview(item)" matTooltip="review">Leave Review</ion-button>
                      </div>
                      <div *ngSwitchCase="3">
                        <ion-button (click)="ViewOrder(item)" class="red-btn" matTooltip="View" >View</ion-button>
                        
                      </div>
                      <div *ngSwitchCase="4">
                        <ion-button (click)="ViewOrder(item)" class="red-btn" matTooltip="View" >View</ion-button>
                        
                      </div>
                    </div>
              </ng-container>
                  </ng-container>
              <ng-container *ngSwitchDefault>
                {{item[col.key]}}
              </ng-container>
             
          </td>
            </ng-container>
         
       
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
        <mat-paginator #paginator
        [pageSize]="10"
        [pageSizeOptions]="[3, 5, 10]"
        showFirstLastButtons
        >
      </mat-paginator>
        
        
    </div>
   
      <div id="paypal-button"></div>
</ion-content>
